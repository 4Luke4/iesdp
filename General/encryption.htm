<html>


<!-- Mirrored from www25.brinkster.com by HTTrack Website Copier/3.x [XR,YP'2001] -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1250">
<meta http-equiv="Content-Language" content="en-us">
<link href="../ManverusStyle.css" type=text/css rel=stylesheet>
<title>Totorials and Descriptions</title>
</head>

<body>

<h1 align="center">Encryption</h1>
<h2>Description</h2>
<h3>Text resource encryption</h3>
<p>The encryption is a simple XOR encryption scheme with a 512 bit key. If you
are not familiar with encryption, 512 bits is a very large key, but XOR is such
an insecure encryption algorithm that it's scarcely worth encrypting. A
determined attacker can find the key with a minimum of effort, particularly in a
case such as this where there are several files encrypted with the same key. An
encryption scheme of this type is typically used to prevent the casual snooper,
i.e. to prevent a person from &quot;accidentally&quot; seeing something not
meant for their eyes, but it fails miserably when the other party is somewhat
motivated to retrieve the plaintext.</p>
<p>In case you aren't familiar with XOR encryption schemes, the way it works is
that each byte of the plaintext is XOR'd with a byte of the key. The key is
rotated cyclically. In this case, we have 64 bytes of key, so bytes 0-63 of
plaintext are XOR'd with bytes 0-63 of key, bytes 64-127 are XOR'd with bytes
0-63 of key, etc. Only slightly easier to implement than it is to break.</p>
<p>The key used in BG is:</p>
<pre>    88 a8 8f ba 8a d3 b9 f5 ed b1 cf ea aa e4 b5 fb
    eb 82 f9 90 ca c9 b5 e7 dc 8e b7 ac ee f7 e0 ca
    8e ea ca 80 ce c5 ad b7 c4 d0 84 93 d5 f0 eb c8
    b4 9d cc af a5 95 ba 99 87 d2 9d e3 91 ba 90 ca
</pre>
<h3>Executable string encryption</h3>
<p>Some strings in the most recent executables (Icewind Dale) have been
encrypted using a simpler algorithm. These strings were primarily to do with the
cheat codes, which were obscured to prevent their immediate discovery. The
strings are encrypted via the simple algorithm:</p>
<pre>  char = (char + 8) &lt;&lt; 1
</pre>
<p>Apply the previous formula to each character to encrypt. Apply the following
to each, to decrypt.</p>
<pre>  char = (char &gt;&gt; 1) - 8
</pre>
<p>Check also :</p>
<p><a href="../FilesFormats/2DAformat.htm">2DA file format</a>.</p>
</body>


<!-- Mirrored from www25.brinkster.com by HTTrack Website Copier/3.x [XR,YP'2001] -->
</html>
