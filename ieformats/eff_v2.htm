<html>
<head>
<link rel="stylesheet" type="text/css" href="general.css" />
</head>
<body>
<div class="title_main">EFF file format</div>
<br />
<div class="fileheader">Applies to:</div>
<div class="indent1">BG1: TotS, BG2, BG2: ToB, IWD, IWD:HoW, IWD:TotL</div><br />

<div class="fileheader">General Description</div>
<div class="indent1">
The EFF file is an effect description. The size of an EFF file is constant. The 
EFF format is to replace the old  effect structs that appear in  CRE, ITM, and 
SPL files. At least in CRE files, whether EFF V2.0 or the old structs appear is 
indicated by a flag in the header.<br />
</div>
<br />

<div class="fileheader"><a name="effv2">EFF V2.0</a></div>
<div class="indent1">
Overall structure:<br />
<div class="indent1">
  <li><a href="#effv2_Header">Header</a>
  <li><a href="#effv2_Body">Body</a></li>
</div>
<br />
</div>

<div class="fileheader"><a name="effv2_Header">EFF V2.0 Header</a></div>
<br />
<div class="indent1">
<table border="1" width="98%">
  <colgroup>
    <col width="5%">
    <col width="12%">
    <col width="*">
  </colgroup>
  <thead>
    <tr>
      <th>Offset</th>
      <th>Size (data type)</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0x0000</td>
      <td>4 (char array)</td>
      <td>Signature ('EFF ')</td>
    </tr>
    <tr>
      <td>0x0004</td>
      <td>4 (char array)</td>
      <td>Version ('V2.0')</td>
    </tr>
  </tbody>
</table>
</div>
<br />

<div class="fileheader"><a name="effv2_Body">EFF V2.0 Body</a></div>
<br />
<div class="indent1">
<table border="1" width="98%">
  <colgroup>
    <col width="5%">
    <col width="12%">
    <col width="*">
  </colgroup>
  <thead>
    <tr>
      <th>Offset</th>
      <th>Size (data type)</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0x0008</td>
      <td>4 (char array)</td>
      <td>For on disk effects, this is a copy of the Signature field from the
        header. For embedded EFF V2.0 structures, this is zeroed out.</td>
    </tr>
    <tr>
      <td>0x000c</td>
      <td>4 (char array)</td>
      <td>For on disk effects, this is a copy of the Version field from the
        header. For embedded EFF V2.0 structures, this is zeroed out.</td>
    </tr>
    <tr>
      <td>0x0010</td>
      <td>4 (dword)</td>
      <td>Opcode number</td>
    </tr>
    <tr>
      <td>0x0014</td>
      <td>4 (dword)</td>
      <td>Target type</td>
    </tr>
    <tr>
      <td>0x0018</td>
      <td>4 (dword)</td>
      <td>Power</td>
    </tr>
    <tr>
      <td>0x001c</td>
      <td>4 (dword)</td>
      <td>Parameter 1</td>
    </tr>
    <tr>
      <td>0x0020</td>
      <td>4 (dword)</td>
      <td>Parameter 2</td>
    </tr>
    <tr>
      <td>0x0024</td>
      <td>1 (char)</td>
      <td>Timing Mode:
        <div class="indent1">
          0=Duration<br />
          1=Permanent<br />
          2=While equipped<br />
          3=Delayed Duration<br />
          4=Delayed<br />
          5=Delayed (transforms to 8)<br />
          6=Duration?<br />
          7=Permanent?<br />
          8=Permanent (unsaved)<br />
          9=Permanent (after Death)<br />
          10=Trigger<br />
        </div>
      </td>
    </tr>
    <tr>
      <td>0x0025</td>
      <td>1 (char)</td>
      <td><span class="unknown">Unknown</span></td>
    </tr>
    <tr>
      <td>0x0026</td>
      <td>2 (word)</td>
      <td><span class="unknown">Timing ?</span></td>
    </tr>
    <tr>
      <td>0x0028</td>
      <td>4 (dword)</td>
      <td>Duration</td>
    </tr>
    <tr>
      <td>0x002c</td>
      <td>2 (word)</td>
      <td>Probability 1</td>
    </tr>
    <tr>
      <td>0x002e</td>
      <td>2 (word)</td>
      <td>Probability 2</td>
    </tr>
    <tr>
      <td>0x0030</td>
      <td>8 (resref)</td>
      <td>Resource</td>
    </tr>
    <tr>
      <td>0x0038</td>
      <td>4 (dword)</td>
      <td>Dice Thrown</td>
    </tr>
    <tr>
      <td>0x003c</td>
      <td>4 (dword)</td>
      <td>Dice Sides</td>
    </tr>
    <tr>
      <td>0x0040</td>
      <td>4 (dword)</td>
      <td>Save Throw Type: <br />
        <div class="indent1">
          0=None<br />
          1=Spells<br />
          2=Breathe<br />
          4=Death<br />
          8=Wands<br />
          16=Polymorph<br />
          </div>
         NB. If more than 1 saving throw type is specified, the target rolls against their best save.<br />
      </td>
    </tr>
    <tr>
      <td>0x0044</td>
      <td>4 (dword)</td>
      <td>Save Bonus</td>
    </tr>
    <tr>
      <td>0x0048</td>
      <td>4 (dword)</td>
      <td><span class="unknown">Variable ?</span></td>
    </tr>
    <tr>
      <td>0x004c</td>
      <td>4 (dword)</td>
      <td>Primary Type (School)</td>
    </tr>
    <tr>
      <td>0x0050</td>
      <td>4 (dword)</td>
      <td><span class="unknown">Unknown</span></td>
    </tr>
    <tr>
      <td>0x0054</td>
      <td>4 (dword)</td>
      <td><span class="unknown">Lowest affected level (transferred from source)</span></td>
    </tr>
    <tr>
      <td>0x0058</td>
      <td>4 (dword)</td>
      <td><span class="unknown">Highest affected level (transferred from source)</span></td>
    </tr>
    <tr>
      <td>0x005c</td>
      <td>4 (dword)</td>
      <td>Resistance Type</td>
    </tr>
    <tr>
      <td>0x0060</td>
      <td>1 (char)</td>
      <td>Parameter 3</td>
    </tr>
    <tr>
      <td>0x0061</td>
      <td>1 (char)</td>
      <td>Parameter 4</td>
    </tr>
    <tr>
      <td>0x0062</td>
      <td>2 (word)</td>
      <td><span class="unknown">Unknown</span></td>
    </tr>
    <tr>
      <td>0x0064</td>
      <td>4 (dword)</td>
      <td><span class="unknown">Unknown</span></td>
    </tr>
    <tr>
      <td>0x0068</td>
      <td>4 (dword)</td>
      <td><span class="unknown">Unknown</span></td>
    </tr>
    <tr>
      <td>0x006c</td>
      <td>4 (dword)</td>
      <td><span class="unknown">Unknown</span></td>
    </tr>
    <tr>
      <td>0x0070</td>
      <td>8 (resref)</td>
      <td>VVC Resource</td>
    </tr>
    <tr>
      <td>0x0078</td>
      <td>8 (resref)</td>
      <td>Resource 2</td>
    </tr>
    <tr>
      <td>0x0080</td>
      <td>4 (dword)</td>
      <td>Caster X Position</td>
    </tr>
    <tr>
      <td>0x0084</td>
      <td>4 (dword)</td>
      <td>Caster Y Position</td>
    </tr>
    <tr>
      <td>0x0088</td>
      <td>4 (dword)</td>
      <td>Target X Position</td>
    </tr>
    <tr>
      <td>0x008c</td>
      <td>4 (dword)</td>
      <td>Target Y Position</td>
    </tr>
    <tr>
      <td>0x0090</td>
      <td>4 (dword)</td>
      <td><span class="unknown">Unknown</span></td>
    </tr>
    <tr>
      <td>0x0094</td>
      <td>8 (resref)</td>
      <td>Effect Source</td>
    </tr>
    <tr>
      <td>0x009c</td>
      <td>4*3 (dword)</td>
      <td><span class="unknown">Unknown</span></td>
    </tr>
    <tr>
      <td>0x00a8</td>
      <td>32 (bytes)</td>
      <td>Variable</td>
    </tr>
    <tr>
      <td>0x00c8</td>
      <td>2 (dword)</td>
      <td><span class="unknown">Caster level?</span></td>
    </tr>
    <tr>
      <td>0x00c8</td>
      <td>6 (bytes)</td>
      <td><span class="unknown">Unknown</span></td>
    </tr>
    <tr>
      <td>0x00d0</td>
      <td>4 (dword)</td>
      <td>Secondary Type</td>
    </tr>
    <tr>
      <td>0x00d4</td>
      <td>4*15 (dword)</td>
      <td><span class="unknown">Unknown</span></td>
    </tr>
  </tbody>
</table>
</div>
</body>
</html>
