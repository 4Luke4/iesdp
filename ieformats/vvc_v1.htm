<html>
<head>
<link rel="stylesheet" type="text/css" href="general.css" />
</head>
<body>
<div class="title_main">VVC file format</div>
<br />
<div class="fileheader">Applies to:</div>
<div class="indent1">BG2, BG2: ToB</div>
<br />

<div class="fileheader">General Description</div>
<div class="indent1">
Visual 'spell casting' effects with sounds attached. A VVC file can play a BAM file and, optionally a sound file.
They are invoked by some script actions like CreateVisualEffect or CreateVisualEffectObject - they are not hardcoded in exe and new VVC's can easily be 
added and used in the game. VVCs are used in the &quot;Play 3D effect&quot; in spells and items.<br />
These files have constant length 1ECh bytes.<br />
<br />

VVC Files use a 3D co-ordinates system when playing the exact location of VVC animations. Without getting into the inner mechanics of 3d animation, Infinity Engine Games are "shot" from an isometric angle, which means that the X-Y-Z axis need to be perceived within this isometric frame to properly understand how your VVC files will play.<br />
<br />
Below is an in-game screenshot which hi-lights each axis. Accordingly:<br />
<div class="indent1">
  X is up or down.<br />
  Y is the distance between the feet of the character.<br />
  Z is the distance between the head of the character and the BAM.<br />
</div>
<br />

<img src="../images/vvcscreenie.jpg">
</div>
<br />

<div class="fileheader">Detailed Description</div>
<div class="indent1">
<br />
<table border="1" width="98%">
  <colgroup>
    <col width="5%">
    <col width="12%">
    <col width="*">
  </colgroup>
  <tr>
    <th>Offset</th>
    <th>Size (data type)</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>0x0000</td>
    <td>4 (char array)</td>
    <td>Signature ('VVC ')</td>
  </tr>
  <tr>
    <td>0x0004</td>
    <td>4 (char array)</td>
    <td>Version ('V1.0')</td>
  </tr>
  <tr>
    <td>0x0008</td>
    <td>8 (resref)</td>
    <td>Animation resref (BAM)</td>
  </tr>
  <tr>
    <td>0x0010</td>
    <td>8 (resref ?)</td>
    <td><span class="unknown">Unknown</span></td>
  </tr>
  <tr>
    <td>0x0018</td>
    <td>2 (word)</td>
    <td>Misc. flags<br />
     <div class="indent1">
       <span class="unknown">bit 0: Unknown</span><br />
       bit 1: Tranlucent<br />
       <span class="unknown">bit 2: Unknown</span><br />
       bit 3: Transparent<br />
       bit 4: Mirror Y axis<br />
       bit 5: Mirror X axis<br />
       <span class="unknown">bit 6: Unknown</span><br />
       <span class="unknown">bit 7: Unknown</span><br />
       <span class="unknown"> bit 8: Unknown </span><br />
       bit 9: Blend <br />
       <span class="unknown"> bit 10: Unknown </span><br />
       <span class="unknown"> bit 11: Unknown </span><br />
       <span class="unknown"> bit 12: Unknown </span><br />
       <span class="unknown"> bit 13: Unknown </span><br />
       <span class="unknown"> bit 14: Unknown </span><br />
       <span class="unknown"> bit 15: Unknown </span><br />
     </div>
  </tr>
  <tr>
    <td>0x001a</td>
    <td>2 (word)</td>
    <td>Tint:<br />
      <div class="indent1">
        <span class="unknown"> bit 0: Unknown </span><br />
        <span class="unknown"> bit 1: Unknown </span><br />
        <span class="unknown"> bit 2: Unknown </span><br />
        bit 3: Greyscale<br />
        <span class="unknown"> bit 4: Unknown </span><br />
        bit 5: Glowing<br />
        <span class="unknown"> bit 6: Unknown </span><br />
        <span class="unknown"> bit 7: Unknown </span><br />
        <span class="unknown"> bit 8: Unknown </span><br />
        bit 9: Red<br />
        <span class="unknown"> bit 10: Unknown </span><br />
        <span class="unknown"> bit 11: Unknown </span><br />
        <span class="unknown"> bit 12: Unknown </span><br />
        <span class="unknown"> bit 13: Unknown </span><br />
        <span class="unknown"> bit 14: Unknown </span><br />
        <span class="unknown"> bit 15: Unknown </span><br />
    </div>
    </td>
  </tr>
  <tr>
    <td>0x001c</td>
    <td>4 (dword)</td>
    <td><span class="unknown">Unknown, unused? (always 0)</span></td>
  </tr>
  <tr>
    <td>0x0020</td>
    <td>4 (dword)</td>
    <td>
      <div class="indent1">
        bit 0: Looping<br />
        bit 1: Sequence 2<br />
        bit 2: Sequence 4<br />
        <span class="unknown">bit 6: Wallgroups do not cover</span><br />
        bit 8: Use BAM<br />
      </div>
      <br />
      <div class="indent1">
        <li>00= Play only the first sound (0x0078 , no graphic or second sound
          (0x0080))</li>
        <li>01= Play both sounds (repeat the second for the duration of the
          effect) but without graphic</li>
        <li>02= Play both sounds, one after the other, for the duration of the
          effect (without graphic)</li>
        <li>03= same as 01</li>
        <li>04= same as 02</li>
        <li>05= same as 01</li>
        <li>06= same as 02</li>
        <li>07= same as 01</li>
        <li>08= Play the BAM sequence only once with both sounds, ignore Y and Z
          positions and repeat this for the duration of the effect.</li>
        <li>09= Play the BAM sequence with both sound, the first only once and
          the other for the duration of the effect, ignore Y and Z positions.</li>
        <li>0A=same as 08</li>
        <li>0B=same as 09</li>
        <li>0C= Play the BAM sequence only once with both sounds, use Y and Z
          positions and repeat this for the duration of the effect.</li>
        <li>0D= Play the BAM sequence with both sound, the first only once and
          the other for the duration of the effect, use Y and Z positions.</li>
      </div>
    </td>
  </tr>
  <tr>
    <td>0x0024</td>
    <td>4 (dword)</td>
    <td><span class="unknown">Unknown</span></td>
  </tr>
  <tr>
    <td>0x0028</td>
    <td>4 (dword)</td>
    <td>X position. (Used with 0x0020 if it is set to 0C or 0D, as Y and Z). 00 is the smallest.</td>
  </tr>
  <tr>
    <td>0x002c</td>
    <td>4 (dword)</td>
    <td>Y position. Distance between feet and animation. 00 is the highest and FF is the lowest.</td>
  </tr>
  <tr>
    <td>0x0030</td>
    <td>4 (dword)</td>
    <td><span class="unknown">Unknown</span></td>
  </tr>
  <tr>
    <td>0x0034</td>
    <td>4 (dword)</td>
    <td>Frame rate. (1 = slow. Suggested value is 20)</td>
  </tr>
  <tr>
    <td>0x0038</td>
    <td>4 (dword)</td>
    <td>Face Target</td>
  </tr>
  <tr>
    <td>0x003c</td>
    <td>4 (dword)</td>
    <td><span class="unknown">Unknown</span></td>
  </tr>
  <tr>
    <td>0x0040</td>
    <td>4 (dword)</td>
    <td>Position:
      <div class="indent1">
        bit 0: Orbit target<br />
        bit 1: Relative to target<br />
      </div>
    </td>
  </tr>
  <tr>
    <td>0x0044</td>
    <td>4 (dword)</td>
    <td><span class="unknown">Unknown</span></td>
  </tr>
  <tr>
    <td>0x0048</td>
    <td>4 (dword)</td>
    <td><span class="unknown">Unknown</span></td>
  </tr>
  <tr>
    <td>0x004c</td>
    <td>4 (dword)</td>
    <td>Z position. Distance between head and animation. 00 is the lowest and FF is the highest.</td>
  </tr>
  <tr>
    <td>0x0050</td>
    <td>4 (dword)</td>
    <td><span class="unknown">Unknown</span></td>
  </tr>
  <tr>
    <td>0x0054</td>
    <td>8 (resref ?)</td>
    <td><span class="unknown">Unknown</span></td>
  </tr>
  <tr>
    <td>0x005c</td>
    <td>4 (dword)</td>
    <td>Duration</td>
  </tr>
  <tr>
    <td>0x0060</td>
    <td>8 (resref ?)</td>
    <td><span class="unknown">Unknown, always 0</span></td>
  </tr>
  <tr>
    <td>0x0068</td>
    <td>4 (dword)</td>
    <td>First BAM sequence (introduction)</td>
  </tr>
  <tr>
    <td>0x006c</td>
    <td>4 (dword)</td>
    <td>Second BAM sequence (duration)</td>
  </tr>
  <tr>
    <td>0x0070</td>
    <td>8 (resref ?)</td>
    <td><span class="unknown">Unknown</span></td>
  </tr>
  <tr>
    <td>0x0078</td>
    <td>8 (resref)</td>
    <td>Resref to the WAVC file - (introduction)</td>
  </tr>
  <tr>
    <td>0x0080</td>
    <td>8 (resref)</td>
    <td>Resref to the WAVC file (duration)</td>
  </tr>
  <tr>
    <td>0x0088</td>
    <td>4 (long)</td>
    <td><span class="unknown">Unknown, unused?</span></td>
  </tr>
  <tr>
    <td>0x008c</td>
    <td>4 (long)</td>
    <td><span class="unknown">Unknown, unused?</span></td>
  </tr>
  <tr>
    <td>0x0090</td>
    <td>4 (dword)</td>
    <td>Third BAM sequence (ending)</td>
  </tr>
  <tr>
    <td>0x0094</td>
    <td>8 (resref)</td>
    <td><span class="unknown">Resref to the WAVC file (ending)?</span></td>
  </tr>
  <tr>
    <td>0x009c</td>
    <td>336 (bytes)</td>
    <td>Unknown, unused</td>
  </tr>
</table>
</div>
</body>
</html>
