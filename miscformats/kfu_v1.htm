<html>
<head>
<link rel="stylesheet" type="text/css" href="general.css" />
</head>
<body>
<div class="title_main"> KFU File Format </div>
<br />
<div class="fileheader">Applies to:</div>
<div class="indent1">Winbiff</div><br />

<div class="fileheader">General Description</div>
<div class="indent1">
Here's the overview of the KFU file format I used in WinBiff to allow ppl to 
export biffs. Necessary info about the biff as well as string references used 
by files in the biff are exported. Someone else can then import the file to 
add everything to his own keyfile and dialog.tlk without overwriting stuff.<br />
</div>
<br />

<div class="fileheader">Detailed Description</div>
<div class="indent1">
Overall Structure:<br />
<div class="indent1">
  <li><a href="#kfu_v1_Header">KFU V1 Header</a></li>
  <li><a href="#kfu_v1_Biff_Entry">KFU V1 Biff Entry</a></li>
  <li><a href="#kfu_v1_Resource_Entry">KFU V1 Resource Entry</a></li>
  <li><a href="#kfu_v1_Stringref_Entry">KFU V1 Strref Entry</a></li>
</div>
<br />
</div>

<div class="fileheader"><a name="kfu_v1_Header">KFU V1 Header</a></div>
<br />
<div class="indent1">
<table border="1" width="98%">
  <colgroup>
    <col width="5%">
    <col width="12%">
    <col width="*">
  </colgroup>
  <tr>
    <th>Offset</th>
    <th>Size (data type)</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>0x0000</td>
    <td>4(char array)</td>
    <td>Signature</td>
  </tr>
  <tr>
    <td>0x0004</td>
    <td>4(char array)</td>
    <td>Version</td>
  </tr>
  <tr>
    <td>0x0008</td>
    <td>4(dword)</td>
    <td>Number of biff entries</td>
  </tr>
  <tr>
    <td>0x000c</td>
    <td>4(dword)</td>
    <td>Offset to first biff entry</td>
  </tr>
  <tr>
    <td>0x0010</td>
    <td>4(dword)</td>
    <td>Number of strrefs to add to dialog.tlk</td>
  </tr>
  <tr>
    <td>0x0014</td>
    <td>4(dword)</td>
    <td>Offset to strref entries</td>
  </tr>
</table>
</div>
<br />

<div class="fileheader"><a name="kfu_v1_Biff_Entry">KFU V1 Biff Entry</a></div>
<br />
<div class="indent1">
<table border="1" width="98%">
  <colgroup>
    <col width="5%">
    <col width="12%">
    <col width="*">
  </colgroup>
  <tr>
    <th>Offset</th>
    <th>Datatype</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>0x0000</td>
    <td>4(dword)</td>
    <td>Size of biff</td>
  </tr>
  <tr>
    <td>0x0004</td>
    <td>4(dword)</td>
    <td>Length of filename</td>
  </tr>
  <tr>
    <td>0x0008</td>
    <td>4(dword)</td>
    <td>Offset to filename</td>
  </tr>
  <tr>
    <td>0x000c</td>
    <td>4(dword)</td>
    <td>Number of resources</td>
  </tr>
  <tr>
    <td>0x0010</td>
    <td>4(dword)</td>
    <td>Offset to resources</td>
  </tr>
</table>
</div>
<br />

<div class="fileheader"><a name="kfu_v1_Resource_Entry">KFU V1 Resource Entry</a></div>
<br />
<div class="indent1">
<table border="1" width="98%">
  <colgroup>
    <col width="5%">
    <col class="col2" width="12%">
    <col class="col3" width="*">
  </colgroup>
  <tr>
    <th>Offset</th>
    <th>Datatype</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>0x0000</td>
    <td>8(resref)</td>
    <td>Resource name</td>
  </tr>
  <tr>
    <td>0x0008</td>
    <td>2(word)</td>
    <td>Resource type</td>
  </tr>
</table>
</div>
<br />

<div class="fileheader"><a name="kfu_v1_Stringref_Entry">KFU V1 Strref Entry</a></div>
<br />
<div class="indent1">
<table border="1" width="98%">
  <colgroup>
    <col width="5%">
    <col width="12%">
    <col width="*">
  </colgroup>
  <tr>
    <th>Offset</th>
    <th>Datatype</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>0x0000</td>
    <td>4(dword)</td>
    <td>Length of string</td>
  </tr>
  <tr>
    <td>0x0004</td>
    <td>4(dword)</td>
    <td>Offset to string</td>
  </tr>
  <tr>
    <td>0x0008</td>
    <td>4(dword)</td>
    <td>Offset in bif file to change to new strref</td>
  </tr>
  <tr>
    <td>0x000c</td>
    <td>4(dword)</td>
    <td>Bif Index</td>
  </tr>
</table>
</div>
</body>
</html>
